<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sähköpyörän rangelaskuri</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #fff;
            color: #001f3f;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 797.6px;
            margin: 20px auto;
            background-color: #001f3f;
            padding: 20px;
            border-radius: 8px;
            color: #fff;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header img {
            width: 50%;
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
        }
        .slider-container {
            margin-bottom: 20px;
        }
        .slider-container label {
            display: block;
            margin-bottom: 5px;
        }
        .slider {
            width: 100%;
            height: 25px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            transition: opacity .15s ease-in-out;
        }
        .slider:hover {
            opacity: 1;
        }
        .submit-button {
            width: 100%;
            padding: 10px;
            background-color: #001f3f;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            cursor: pointer;
        }
        .results {
            margin-top: 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            background-color: #4CAF50;
            color: white;
            padding: 10px;
            border-radius: 5px;
        }
        .small-text {
            font-size: 12px;
            margin-top: 10px;
            text-align: center;
        }
        .small-text a {
            color: #add8e6;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="https://media.nsbrands.com/w_706/cropped-logo-kuntokauppa" alt="Kuntokauppa Logo">
            <h1>Sähköpyörän rangelaskuri</h1>
        </div>
        <div class="slider-container">
            <label for="battery">Akun koko (Wh): <span id="battery-value">250</span> Wh</label>
            <input type="range" id="battery" name="battery" min="250" max="1008" value="250" class="slider">
        </div>
        <div class="slider-container">
            <label for="weight">Pyöräilijän paino (kg): <span id="weight-value">50</span> kg</label>
            <input type="range" id="weight" name="weight" min="50" max="120" value="50" class="slider">
        </div>
        <div class="slider-container">
            <label for="temperature">Ulkolämpötila (°C): <span id="temperature-value">-20</span> °C</label>
            <input type="range" id="temperature" name="temperature" min="-20" max="30" value="-20" class="slider">
        </div>
        <div class="slider-container">
            <label for="assist">Avustusasto:</label>
            <input type="range" id="assist" name="assist" min="1" max="4" value="1" class="slider">
            <div>
                <span id="assist-value">Eko</span>
            </div>
        </div>
        <button class="submit-button" onclick="calculateRange()">Laske matka</button>
        <div class="results" id="results"></div>
        <div class="small-text">
            Arvot on laskettu Uppsalan yliopiston Mario Nikolovin Pro Gradun keskimääräisten arvojen perusteell 
            (<a href="https://uu.diva-portal.org/smash/get/diva2:1840744/FULLTEXT01.pdf">https://uu.diva-portal.org/smash/get/diva2:1840744/FULLTEXT01.pdf</a>)
        </div>
    </div>
    <script>
        const battery = document.getElementById('battery');
        const weight = document.getElementById('weight');
        const temperature = document.getElementById('temperature');
        const assist = document.getElementById('assist');

        battery.oninput = function() {
            document.getElementById('battery-value').innerText = this.value;
        }
        weight.oninput = function() {
            document.getElementById('weight-value').innerText = this.value;
        }
        temperature.oninput = function() {
            document.getElementById('temperature-value').innerText = this.value;
        }
        assist.oninput = function() {
            const assistLevels = ['Eko', 'Normaali', 'Korkea', 'Turbo'];
            document.getElementById('assist-value').innerText = assistLevels[this.value - 1];
        }

        function calculateRange() {
            const batteryValue = parseInt(battery.value);
            const weightValue = parseInt(weight.value);
            const temperatureValue = parseInt(temperature.value);
            const assistValue = parseInt(assist.value);

            // Average power consumption: 0.4 Ah/km for a 250W e-bike
            const baseConsumption = 0.4; // Ah/km
            const batteryCapacity = batteryValue / 250 * 20; // Converting Wh to Ah for a 250W e-bike

            // Adjust the base consumption based on assistance level
            const assistMultipliers = [1, 0.7576, 0.5455, 0.5152]; // Multipliers for Eko, Normaali, Korkea, Turbo
            const adjustedConsumption = baseConsumption * assistMultipliers[assistValue - 1];

            // Calculate range (battery capacity divided by adjusted consumption per km)
            let range = batteryCapacity / adjustedConsumption;

            // Adjust range based on weight
            range -= (weightValue - 75) * 0.1; // Reduce range by 0.1 km per kg over 75 kg

            // Adjust range based on temperature
            let capacityPercentage = 100;
            if (temperatureValue <= -20) {
                capacityPercentage = 60; // Average of 50% - 70%
            } else if (temperatureValue <= 0) {
                capacityPercentage = 85; // Average of 80% - 90%
            } else if (temperatureValue <= 25) {
                capacityPercentage = 100; // 100%
            } else if (temperatureValue <= 30) {
                capacityPercentage = 92.5; // Average of 90% - 95%
            } else if (temperatureValue <= 40) {
                capacityPercentage = 85; // Average of 80% - 90%
            }
            range *= (capacityPercentage / 100); // Adjust range by battery capacity percentage

            document.getElementById('results').innerText = `Arvioitu matka: ${range.toFixed(2)} km`;
        }
    </script>
</body>
</html>
